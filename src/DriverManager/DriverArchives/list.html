<!DOCTYPE html>
<html class="x-admin-sm">
<head>
    <meta charset="UTF-8">
    <title>司机档案</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
    <link rel="stylesheet" href="../../css/font.css">
    <link rel="stylesheet" href="../../css/xadmin.css">
    <link rel="stylesheet" href="../../lib/TableFilter/tableFilter.css">
    <script src="../../lib/layui/layui.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../js/xadmin.js"></script>
    <script src="../../lib/TableFilter/tableFilter.js"></script>
    <script src="../../js/common.js"></script>
    <!--[if lt IE 9]>
    <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
    <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<div class="x-nav">
     <span class="layui-breadcrumb">
       <a>司机管理</a>
       <a>
         <cite>司机档案</cite>
       </a>
    </span>
    <a class="layui-btn layui-btn-small" style="line-height:1.6em;margin-top:3px;float:right" onclick="location.reload()" title="刷新">
        <i class="layui-icon layui-icon-refresh" style="line-height:30px"></i>
    </a>
</div>
<div class="layui-fluid">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md12">
            <div class="layui-card">
                <div class="layui-card-header">
                    <button class="layui-btn" onclick="xadmin.open('新增司机','./add.html',1200,600)">新增</button>
                    <button class="layui-btn layui-bg-orange" onclick="xadmin.open('预警设置','./warn.html',340,370)">预警设置</button>
                    <button class="layui-btn layui-bg-blue" onclick="xadmin.open('导出','./list-add.html',600,400)">导出</button>
                    <button class="layui-btn layui-bg-black" onclick="xadmin.open('表格设置','./list-add.html',600,400)">表格设置</button>
                </div>
                <div class="layui-card-body" id="doc-content">
                    <table id="driverList" lay-filter="driverList"></table>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<script type="text/html" id="barDemo">
<a class="layui-btn layui-btn-xs layui-bg-blue" lay-event="edit"  onclick="xadmin.open('修改司机','./edit.html',1200,600)">修改</a>
<a class="layui-btn layui-btn-xs layui-bg-red" lay-event="edit" onclick="xadmin.open('审核司机','./audit.html',1200,600)">审核</a>
<a class="layui-btn layui-btn-xs layui-bg-orange" lay-event="info" onclick="xadmin.open('查看司机','./info.html',1200,600)">查看</a>
<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
<a class="layui-btn layui-bg-cyan layui-btn-xs" lay-event="del">日志</a>
</script>
<script>
layui.config({
    base:'../../lib/TableFilter/'
}).use(['jquery', 'table', 'code', 'tableFilter'], function(){
    layui.code();
    var $ = layui.jquery,
        table = layui.table,
        tableFilter = layui.tableFilter;

    //API演示
    var driverList = table.render({
        elem: '#driverList',
        height : '313',
        url:ipUrl+'/admin/driver/info/list?staffId=17718571615',
        page: true,
        request: {
            pageName: 'pageNumber', //页码的参数名称
            limitName: 'pageSize' //每页数据量的参数名
        },
        parseData: function (res) {
            if(res.code == 0){
                return {
                    "code": res.code,
                    "msg": res.message,
                    "count": res.data.totalSize,
                    "data": res.data.driverInfoListDtoList
                };
            }

        },
        cols: [[
            {checkbox: true},
            {field: 'name',  title: '司机姓名'},
            {field: 'phone', title: '司机手机'},
            {field: 'idNum', title: '司机身份证号'},
            {field: 'drivingAge', title: '驾龄'},
            {field: 'driverType', title: '司机类型'},
            {field: 'driveLicenceType', title: '驾照类型'},
            {field: 'idLicenceValidity', title: '身份证有效期'},
            {field: 'driveLicenceValidity', title: '驾照有效期'},
            {field: 'qualificationsValidity', title: '从业资格证有效期'},
            {field: 'status', title: '司机状态'},
            {field: 'address', title: '司机当前住址'},
            {field: 'wishJourney', title: '意向线路'},
            {field: 'wishJourney1', title: '常跑线路'},
            {field: 'deposit', title: '押金'},
            {field: 'accountBank', title: '开户行'},
            {field: 'accountBankAddress', title: '开户行地址'},
            {field: 'accountNumber', title: '账号号码'},
            {field: 'accountName', title: '账号姓名'},
            { title:'操作', toolbar: '#barDemo'}
        ]],
        done: function(res, curr, count){
            console.log("监听where:", this.where);

            //非常重要！如果使table.reload()后依然使用过滤，就必须将过滤组件也reload()一下
            driverListFilterIns.reload()
        }
    });

    var driverListFilterIns = tableFilter.render({
        'elem' : '#driverList',
        // 'parent' : '#doc-content',
        'mode' : 'local',
        'filters' : [
            {field: 'name',  type:'input'},
            {field: 'phone', type:'input'},
            {field: 'idNum', type:'input'},
            {field: 'drivingAge', type:'input'},
            {field: 'driverType', type:'radio', data:[{ "key":"1", "value":"外调"},{ "key":"2", "value":"自营"},{ "key":"3", "value":"合同"}]},
            {field: 'driveLicenceType', type:'radio', data:[{ "key":"1", "value":"A1"},{ "key":"2", "value":"A2"},{ "key":"3", "value":"A3"}, { "key":"4", "value":"B1"},{ "key":"5", "value":"B2"},{ "key":"6", "value":"C1"},{ "key":"7", "value":"C2"},{ "key":"8", "value":"C3"}]},
            {field: 'idLicenceValidity', type:'date'},
            {field: 'driveLicenceValidity', type:'input'},
            {field: 'qualificationsValidity', type:'input'},
            {field: 'status', type:'input'},
            {field: 'address', type:'input'},
            {field: 'wishJourney', type:'input'},
            {field: 'wishJourney1', type:'input'},
            {field: 'deposit', type:'input'},
            {field: 'accountBank', type:'input'},
            {field: 'accountBankAddress',type:'input'},
            {field: 'accountNumber', type:'input'},
            {field: 'accountName', type:'input'}
        ],
        'done': function(filters){
            debugger

        }
    })
});

/*用户-停用*/
function member_stop(obj,id){
    layer.confirm('确认要停用吗？',function(index){

        if($(obj).attr('title')=='启用'){

            //发异步把用户状态进行更改
            $(obj).attr('title','停用')
            $(obj).find('i').html('&#xe62f;');

            $(obj).parents("tr").find(".td-status").find('span').addClass('layui-btn-disabled').html('已停用');
            layer.msg('已停用!',{icon: 5,time:1000});

        }else{
            $(obj).attr('title','启用')
            $(obj).find('i').html('&#xe601;');

            $(obj).parents("tr").find(".td-status").find('span').removeClass('layui-btn-disabled').html('已启用');
            layer.msg('已启用!',{icon: 5,time:1000});
        }

    });
}

/*用户-删除*/
function member_del(obj,id){
    layer.confirm('确认要删除吗？',function(index){
        //发异步删除数据
        $(obj).parents("tr").remove();
        layer.msg('已删除!',{icon:1,time:1000});
    });
}



function delAll (argument) {

    var data = tableCheck.getData();

    layer.confirm('确认要删除吗？'+data,function(index){
        //捉到所有被选中的，发异步进行删除
        layer.msg('删除成功', {icon: 1});
        $(".layui-form-checked").not('.header').parents('tr').remove();
    });
}
</script>
</html>
